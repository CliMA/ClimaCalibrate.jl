<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ClimaCalibrate · ClimaCalibrate.jl</title><meta name="title" content="ClimaCalibrate · ClimaCalibrate.jl"/><meta property="og:title" content="ClimaCalibrate · ClimaCalibrate.jl"/><meta property="twitter:title" content="ClimaCalibrate · ClimaCalibrate.jl"/><meta name="description" content="Documentation for ClimaCalibrate.jl."/><meta property="og:description" content="Documentation for ClimaCalibrate.jl."/><meta property="twitter:description" content="Documentation for ClimaCalibrate.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaCalibrate.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Getting Started</a></li><li><a class="tocitem" href="../literate_example/">Distributed Calibration Tutorial</a></li><li><a class="tocitem" href="../backends/">Backends</a></li><li><a class="tocitem" href="../emulate_sample/">Emulate and Sample</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>ClimaCalibrate</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ClimaCalibrate</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaCalibrate.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaCalibrate.jl/blob/main/docs/src/interface.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ClimaCalibrate"><a class="docs-heading-anchor" href="#ClimaCalibrate">ClimaCalibrate</a><a id="ClimaCalibrate-1"></a><a class="docs-heading-anchor-permalink" href="#ClimaCalibrate" title="Permalink"></a></h1><p>ClimaCalibrate is just a placeholder name, we can bikeshed on the name later</p><p>ClimaCalibrate provides a framework for running component model calibrations using EnsembleKalmanProcesses. This way, artifacts for calibration experiments can be stored</p><p>To use this framework, individual models (or the coupler) will define their own versions of the functions provided in the interface (<code>get_config</code>, <code>get_forward_model</code>, and <code>run_forward_model</code>).</p><p>Calibrations can either be run using pure Julia or if required, an Sbatch pipeline for the Caltech Resnick cluster.</p><p>The framework has three main interface components:</p><p><strong>EKP</strong>: Contains the functions for initializing calibration, updating ensembles, and additional emulate/sample steps.</p><p><strong>Model</strong>: Contains hooks/function stubs for component models to integrate. This consists of three functions</p><ul><li><p><code>forward_model = get_forward_model(Val{experiment_id})</code>: Dispatches on the experiment ID to find the right component model.</p></li><li><p><code>config = get_config(physical_model, experiment_id, iteration, member)</code>: Gets the configuration for the model to run</p></li><li><p><code>run_forward_model(physical_model, config)</code>: Runs the forward model, which is meant to save output to a file</p></li></ul><p><strong>Slurm</strong>: Provides utilities for running experiments on the central cluster, file and error handling. It would be good to separate this from the Julia package, since this is largely specific to the central cluster.</p><h1 id="Component-Model"><a class="docs-heading-anchor" href="#Component-Model">Component Model</a><a id="Component-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Component-Model" title="Permalink"></a></h1><h2 id="Model-interface"><a class="docs-heading-anchor" href="#Model-interface">Model interface</a><a id="Model-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Model-interface" title="Permalink"></a></h2><p>The model must provide implementations of the following function stubs. This will be common across experiments for a single component model.</p><p><code>physical_model = get_physical_model(Val{experiment_id})</code>: Dispatches on the experiment ID to find the right component model.</p><p><code>config = get_config(physical_model, experiment_id, iteration, member)</code>: Gets the configuration for the model to run</p><p><code>run_forward_model(physical_model, config)</code>: Runs the forward model, which is meant to save output to a file</p><h2 id="Experiments"><a class="docs-heading-anchor" href="#Experiments">Experiments</a><a id="Experiments-1"></a><a class="docs-heading-anchor-permalink" href="#Experiments" title="Permalink"></a></h2><p>This will define an individual experiment to work with the model interface and ClimaCalibrate. An experiment should be self-documented and contained. </p><p>Experiments need to have the following:</p><ul><li><strong>EKP configuration YAML</strong>: This holds the configuration for the experiment, including paths to other experiment metada such as the prior distribution file.This contains:<ul><li>Path to the prior distribution</li><li>Path to truth data and noise JLD2 files</li><li>Ensemble size</li><li>Number of iterations</li><li>Output directory</li><li>In the future, other EKP configuration arguments (Unscented etc)</li></ul></li><li><strong>Observational data and noise</strong>: Serialized to JLD2</li><li><strong>Prior distribution file</strong>: TOML format. Distributions should generally use the <a href="https://clima.github.io/EnsembleKalmanProcesses.jl/dev/API/ParameterDistributions/#EnsembleKalmanProcesses.ParameterDistributions.constrained_gaussian">constrained_gaussian</a> function.</li><li><strong>Project.toml and compat</strong>: Setting compat requirements is important for reproducibility, and allows for additional imports needed in the observation map.</li><li><strong>Observation map</strong>: A function <code>observation_map</code> which computes the observation map for a full ensemble.<ul><li>The <code>observation_map</code> function can live in a file in the experiment folder which is <code>included</code> in the calibration script. Alternatively, all observation maps for a given model can be kept in the model interface to avoid using <code>include</code>. However, it has the drawbacks of adding unnecessary dependencies for a given experiment.</li></ul></li><li><strong>Model configuration file</strong> (optional): May be required by the model interface. This should inherit values like the output directory for the EKP config if applicable.</li><li><strong>Script for generating the observational data</strong> (optional): Ideal for reproducibility, especially for perfect model scenarios.</li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 14 February 2025 18:01">Friday 14 February 2025</span>. Using Julia version 1.10.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
